{"version":3,"sources":["lib/constants.js","sort_script.js"],"names":["getBaseAPIUrl","$","sortList","sortOrder","list","b","s","reduce","accumulator","orig_pos","outerHTML","innerHTML","getAllTheSortScores","products","i","children","length","title","getElementsByClassName","undefined","trim","push","ajax","type","url","constants","data","JSON","stringify","contentType","dataType","success","map","element","failure","errMsg","console","log","chrome","storage","sync","get","betaMode","toSort","items","document","getElementById"],"mappings":"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","file":"sort_script.map","sourceRoot":"../frontend_sandbox/src","sourcesContent":["export function getBaseAPIUrl() {\n    return \"https://ly25jqtuy8.execute-api.us-east-1.amazonaws.com/3elephants-beta/\";\n}\n","import * as constants from './lib/constants'\n\n//This function gets the\n$(function() {\n\n  //Using the cached sort scores, this function should order the list by ecofriendliness\n  function sortList(sortOrder, list, b) {\n\n    var s = sortOrder.reduce((accumulator, orig_pos) => accumulator + b[orig_pos].outerHTML, \"\");\n    list.innerHTML = s;\n\t\t// $(\"#loading\").css(\"display\",\"none\");\n  }\n\n  function getAllTheSortScores(list, b) {\n\n    var products = [];\n    // document.getElementsByTagName(\"body\")[0].innerHTML +='<div id=\"loading\"> <div id=\"loading-image\"class=\"loader\"></div></div>';\n    for (i = 0; i < list.children.length; i++) {\n      if (b[i] == null) {\n        break;\n      }\n      var title = b[i].getElementsByClassName(\"s-access-title\")[0];\n      if (title == null)\n        title = b[i].getElementsByClassName(\"a-size-medium a-color-base a-text-normal\")[0]; //for different layout\n      if (title == null) {\n        title = b[i].getElementsByClassName(\"a-size-base-plus a-color-base a-text-normal\")[0]; //for different layout\n      }\n\n      if (title != undefined) {\n        title = title.innerHTML.trim();\n        products.push(title);\n      }\n\n    }\n\n\n    // Here is where you call the API route with the \"jsonString\" variable\n    $.ajax({\n      type: \"POST\",\n      url: constants.getBaseAPIUrl() +\"GetSearchResultsPageCache\",\n      // The key needs to match your method's input parameter (case-sensitive).\n      data: JSON.stringify(products),\n      contentType: \"application/json; charset=utf-8\",\n      dataType: \"json\",\n      success: function(data) {\n\n        var sortOrder = data.map(element => element.orig_pos);\n\n        sortList(sortOrder, list, b);\n      },\n      failure: function(errMsg) {\n        console.log(errMsg);\n      }\n    });\n\n\n  }\n\n\n  chrome.storage.sync.get({\n    betaMode: true,\n    toSort: true\n  }, function(items) {\n    //get dom element for search results list\n    var list = document.getElementById(\"s-results-list-atf\");\n    if (list == null) {\n\n      if(document.getElementsByClassName(\"s-result-list\") == undefined)\n        return;\n      list = document.getElementsByClassName(\"s-result-list\")[0]; //for different layout\n    }\n    b = list.children;\n\t\tif(items.toSort)\n    \tgetAllTheSortScores(list, b);\n\n\n\n  });\n\n\n\n});\n"]}